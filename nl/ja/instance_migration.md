---

copyright:

  years: 2017, 2019

lastupdated: "2019-02-19"

keywords: migrate, migrating to a resource group, migrate Cloud Foundry

subcollection: resources

---

{:shortdesc: .shortdesc}
{:codeblock: .codeblock}
{:screen: .screen}
{:new_window: target="_blank"}
{:gif: data-image-type='gif'}
{:tip: .tip}

# リソース・グループへの Cloud Foundry サービス・インスタンスおよびアプリのマイグレーション
{: #migrate}

{{site.data.keyword.Bluemix}} の使用経験をよりシンプルでフレキシブルなものにするため、概念的に Cloud Foundry のスペースに類似する[リソース・グループ](/docs/resources?topic=resources-rgs)が導入されました。 リソース・グループには、便利な機能がさらに追加されており、IBM Cloud Identity and Access Management (IAM) を使用したきめ細かいアクセス制御、さまざまな地域にわたってアプリおよびサービスにサービス・インスタンスを接続する機能、およびグループごとの使用量の容易な表示方法などがあります。
{:shortdesc}

IBM では、リソース・グループの利点を活用するために Cloud Foundry からのサービスの移動を開始しています。つまり、リソース・リストでいずれかのサービスの横に ![このサービス・インスタンスをリソース・グループにマイグレーション](images/migrate.svg "このサービス・インスタンスをリソース・グループにマイグレーション") アイコンが表示されている場合は、現在の Cloud Foundry の組織およびスペースからリソース・グループにサービス・インスタンスまたは [{{site.data.keyword.Bluemix_notm}} {{site.data.keyword.dev_console}}](https://cloud.ibm.com/developer/appservice/dashboard) で作成されたアプリを移動するためのマイグレーション計画を開始する必要があります。 {{site.data.keyword.Bluemix_notm}} サービスを Cloud Foundry の組織、スペース、および役割の使用から IAM およびリソース・グループの使用に移行するまでは、既存の Cloud Foundry サービス・インスタンスをリソース・グループにマイグレーションすることはできません。

既存の Cloud Foundry サービス・インスタンスまたは {{site.data.keyword.dev_console}} アプリをリソース・グループにマイグレーションする場合、選択したグループをマイグレーション完了後に変更することはできません。 したがって、マイグレーションの前に、アカウント内のリソースをどのように編成するかを計画することが重要です。 これは、請求可能アカウントをお持ちの場合に、マイグレーション前に 1 つ以上のリソース・グループを作成する必要があることを意味する場合があります。

Cloud Foundry スペースでのリソースの編成と同じ方法で、リソース・グループ内のリソースを編成してみることができます。 リソース・グループの使用について詳しくは、『[リソースをリソース・グループに編成するためのベスト・プラクティス](/docs/resources?topic=resources-bp_resourcegroups)』を参照してください。
{: tip}


## マイグレーションする理由
{: #why_migrate}

### Cloud Foundry サービス・インスタンス
{: #cf_instances}

Cloud IAM アクセス制御およびリソース・グループ内の組織をサポートするサービスには、以下のような利点があります。

* きめ細かなアクセス制御の使用により、個々のサービス・インスタンス、またはリソース・グループ内に編成されたリソースのグループへのアクセス権を設定できます。
* アクセス・グループとリソース・グループを使用してユーザーとリソースを編成することにより、最小数のアクセス・ポリシーのみを設定します。 例えば、開発者の一団がおり、その全員に開発環境のリソースへのアクセス権を付与したい場合は、それらのユーザー全員を開発者アクセス・グループに編成し、次に、彼らがアクセスする必要があるすべてのリソースを単一のリソース・グループに編成できます。 それから、そのアクセス・グループにリソース・グループ内のすべてのリソースへのアクセス権限を付与する単一ポリシーを設定できます。
* リソース・グループの使用量は、Cloud Foundry 組織の使用量を表示するのと同様の方法で表示できます。
* 任意の Cloud Foundry のスペース内のアプリおよびサービスに接続できます。これにより、さまざまな地域からのアプリおよびサービスの接続が可能になります。 マイグレーションした場合、元の Cloud Foundry サービス・インスタンスを別名にし、選択したリソース・グループ内に、リンクされたインスタンスを作成すると、自動的に接続が行われます。 以下の図では、別名を使用して接続がどのように機能するかを示しています。

![サービス・インスタンスを Cloud Foundry スペースにバインドして別名を作成する](images/alias.svg "Cloud Foundry スペースにサービス・インスタンスをバインドして別名を作成する")

### {{site.data.keyword.dev_console}} アプリ
{: #app_services}

以前は、{{site.data.keyword.dev_console}} アプリは Cloud Foundry サービス・インスタンスとのみ関連付けることができました。 現在は、アプリをリソース・グループにマイグレーションすれば、リソース・グループに所属し、Cloud IAM アクセス制御をサポートするサービス・インスタンスにアプリを関連付けることができます。

## マイグレーションできるユーザー
{: #whocanmigrate}

### サービス・インスタンスのために必要なアクセス権限
{: #required_access_instances}

Cloud Foundry サービス・インスタンスをリソース・グループにマイグレーションするには、ユーザーは特定のアクセス権限を持っている必要があります。

* ユーザーは、Cloud Foundry スペースに対する開発者役割、または、インスタンスが属する組織に対する組織管理者 Cloud Foundry 役割を持っている必要があります。
* ユーザーは、インスタンスのマイグレーション先リソース・グループを管理するために、少なくともビューアー IAM 役割を持っている必要があります。
* ユーザーは、サービスに対して少なくともエディター IAM 役割を持っている必要があります。

正しいアクセス権限の割り当てについて詳しくは、『[Cloud Foundry アクセス権限](/docs/iam?topic=iam-cfaccess)』および『[IAM アクセス権限](/docs/iam?topic=iam-userroles#platformrolestable1)』を参照してください。

自分のアクセス権限を確認するには、コンソール・メニュー・バーで**「管理」**&gt;**「アクセス (IAM)」**をクリックしてから、**「ユーザー」**をクリックします。 次に、自分の名前をクリックして、割り当てられている IAM 役割の**「アクセス・ポリシー」**を確認し、アクセスできる組織および割り当てられている Cloud Foundry 役割を**「Cloud Foundry アクセス権限」**で確認します。
{: tip}

### {{site.data.keyword.dev_console}} アプリのために必要なアクセス権限
{: #required_access_apps}

{{site.data.keyword.dev_console}} アプリにアクセス可能な任意のユーザーがそのアプリをマイグレーションできます。 ただし、アプリをマイグレーションしてもそのアプリに関連付けられたサービスはマイグレーションされません。 サービス・インスタンスは別途マイグレーションする必要があります。

## マイグレーションの仕組み
{: #how}

### サービス・インスタンスのマイグレーション
{: #migrate_instances}

サービス・インスタンスを Cloud Foundry の組織とスペースからリソース・グループにマイグレーションすると、新しくリンクされたサービス・インスタンスがリソース・グループ内に作成されます。 Cloud Foundry 組織とスペース内の元のインスタンスは[別名](/docs/resources?topic=resources-connect_app#what_is_alias)になります。 別名は、組織の割り当て量に計上されますが、請求対象になるのはリソース・グループ内のサービス・インスタンスの使用です。

![リソース・グループへの Cloud Foundry サービス・インスタンスのマイグレーション](images/migration.gif){: gif}

サービス・インスタンスのマイグレーションは、Cloud Foundry サービス・インスタンスに関連付けられた ![このサービス・インスタンスをリソース・グループにマイグレーション](images/migrate.svg "このサービス・インスタンスをリソース・グループにマイグレーション") アイコンによってリソース・リストで通知されたら、一度に 1 つずつ行うことができます。

マイグレーション・プロセスを開始する前に、ご使用のサービスの資料を調べて、サービス・インスタンスをリソース・グループにマイグレーションした場合に追加のサービス固有の変更が必要かどうかを確認してください。 例えば、古いインスタンスから新しいインスタンスにデータをマイグレーションしたり、Cloud Foundry 別名を削除する場合、アプリに使用していた資格情報を更新したりする必要がある場合があります。 マイグレーションされたサービスの API に直接呼び出しを行うアプリケーションは、IAM の API キーまたはアクセス・トークンを使用するようにその API 呼び出しを更新する必要があります。
{: tip}

1. **「その他のアクション」**メニューを開きます。
2. **「リソース・グループへのマイグレーション (Migrate to a resource group)」**を選択して開始します。
3. リソース・グループを選択します。
4. **「マイグレーション」**をクリックします。そうすると、インスタンスがマイグレーションされます。
5. 一度にマイグレーションできるインスタンスは 1 つのみであるため、最初のマイグレーションが終わったら、マイグレーション可能なインスタンスのマイグレーションを続けることができます。

インスタンスが正常にマイグレーションされたら、リソース・リストの「サービス」セクションでそれが表示されます。 別名は、リソース・リストの「Cloud Foundry」セクションに残ります。 リソース・リストの Cloud Foundry セクションで ![リンク・アイコン](images/link.svg "別名を表すリンクのアイコン") を使用して、別名を識別できます。

### {{site.data.keyword.dev_console}} アプリのマイグレーション
{: #migrate_apps}

「アプリ・リスト (App List)」ビューの各項目に関連付けられた ![このサービス・インスタンスをリソース・グループにマイグレーション](images/migrate.svg "このサービス・インスタンスをリソース・グループにマイグレーション") アイコンをクリックすることで、アプリは一度に 1 つずつマイグレーションされます。

1. **「メニュー」**アイコン ![「メニュー」アイコン](../icons/icon_hamburger.svg) を選択し、関心のある開発者ポータル (Watson、Mobile、Web Apps など) を選択します。
2. **「アプリ (要アクション) (Apps (Action required))」**リストおよび**「アプリ (マイグレーション済み)(Apps (migrated))」**リストを表示する**「アプリ」**を選択します。
3. **「アプリ (要アクション) (Apps (Action required))」**リストの各項目で、**「マイグレーション (Migrate)」**アイコン ![このサービス・インスタンスをリソース・グループにマイグレーション](images/migrate.svg "このサービス・インスタンスをリソース・グループにマイグレーション") をクリックします。
4. 新規リソース・グループを選択または作成します。
5. **「マイグレーション」**をクリックすると、アプリがマイグレーションされます。
6. アプリが**「アプリ (マイグレーション済み)(Apps (migrated))」**リストに表示されるようになったことを確認してください。
7. 一度にマイグレーションできるアプリは 1 つのみであるため、最初のマイグレーションが終わったら、マイグレーション可能なアプリのマイグレーションを続けることができます。


## 次のステップ
{: #migrate_next_steps}

Cloud Foundry サービス・インスタンスをリソース・グループにマイグレーションした後、アカウント・リソース・グループ内のリソースに対する必要なレベルのアクセス権限が、アカウント内のユーザーに付与されていることを確認する必要があります。 また、ユーザーがアカウント・リソース・グループ内に新しいサービス・インスタンスを作成できるように、リソース・グループを管理するためのアクセス権限を提供することもできます。

リソース・グループ内のリソースへのアクセス権限の割り当てについて詳しくは、『[リソース・グループおよびリソース・グループ内のリソースへのアクセス権限の割り当て](/docs/resources?topic=resources-bp_resourcegroups#assigning_access_rgs)』を参照してください。

また、ご使用のサービスの資料を必ず調べて、マイグレーション完了後に既存のアプリの更新を行う必要があるかどうか確認してください。


## トラブルシューティング
{: #ts_migration}

Cloud Foundry サービス・インスタンスのマイグレーションで問題が発生した場合は、[サービスとリソースに関するトラブルシューティング](/docs/resources?topic=resources-services)を確認してください。
